# GitHub Actions å·¥ä½œæµä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®é…ç½®äº†è‡ªåŠ¨åŒ– CI/CD æµç¨‹ï¼Œæ¯æ¬¡æ¨é€åˆ° main åˆ†æ”¯éƒ½ä¼šè‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒ Docker é•œåƒåˆ° Docker Hubã€‚

## ğŸš€ å·¥ä½œæµç¨‹

### 1. Docker æ„å»ºå’Œå‘å¸ƒ (`docker-publish.yml`)

**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨æ„å»ºå¤šå¹³å° Docker é•œåƒï¼ˆamd64, arm64ï¼‰
- æ¨é€åˆ° Docker Hub
- æ‰§è¡Œå®‰å…¨æ¼æ´æ‰«æ
- æ›´æ–° Docker Hub æè¿°

**è§¦å‘æ¡ä»¶ï¼š**
- æ¨é€åˆ° `main` åˆ†æ”¯
- åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰
- Pull Requestï¼ˆä»…æ„å»ºï¼Œä¸æ¨é€ï¼‰
- æ‰‹åŠ¨è§¦å‘

### 2. å‘å¸ƒç®¡ç† (`release.yml`)

**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨åˆ›å»º GitHub Release
- ç”Ÿæˆæ›´æ–°æ—¥å¿—
- å…³è” Docker é•œåƒç‰ˆæœ¬

**è§¦å‘æ¡ä»¶ï¼š**
- åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰

## ğŸ“ ç‰ˆæœ¬å‘å¸ƒæµç¨‹

### 1. å¸¸è§„æ›´æ–°ï¼ˆæ¨é€åˆ° mainï¼‰

```bash
git add .
git commit -m "fix: ä¿®å¤ç™»å½•é—®é¢˜"
git push origin main
```

**ç»“æœï¼š**
- è‡ªåŠ¨æ„å»ºå¹¶æ¨é€ `latest` æ ‡ç­¾åˆ° Docker Hub
- æ›´æ–° `main` æ ‡ç­¾

### 2. ç‰ˆæœ¬å‘å¸ƒ

```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

**ç»“æœï¼š**
- æ„å»ºå¹¶æ¨é€ä»¥ä¸‹æ ‡ç­¾åˆ° Docker Hubï¼š
  - `v1.0.0`ï¼ˆå®Œæ•´ç‰ˆæœ¬ï¼‰
  - `1.0`ï¼ˆä¸»æ¬¡ç‰ˆæœ¬ï¼‰
  - `1`ï¼ˆä¸»ç‰ˆæœ¬ï¼‰
  - `latest`ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
- åˆ›å»º GitHub Release
- ç”Ÿæˆæ›´æ–°æ—¥å¿—

## ğŸ”§ æ‰‹åŠ¨è§¦å‘æ„å»º

1. è®¿é—®ä»“åº“çš„ Actions é¡µé¢
2. é€‰æ‹© "Docker Build & Push" å·¥ä½œæµ
3. ç‚¹å‡» "Run workflow"
4. é€‰æ‹©åˆ†æ”¯å¹¶è¿è¡Œ

## ğŸ“Š æŸ¥çœ‹æ„å»ºçŠ¶æ€

- **Actions é¡µé¢**ï¼šæŸ¥çœ‹æ‰€æœ‰å·¥ä½œæµè¿è¡Œå†å²
- **README å¾½ç« **ï¼šå®æ—¶æ˜¾ç¤ºæ„å»ºçŠ¶æ€
- **Docker Hub**ï¼šæŸ¥çœ‹é•œåƒæ ‡ç­¾å’Œæ‹‰å–æ¬¡æ•°

## ğŸ›¡ï¸ å®‰å…¨æ‰«æ

æ¯æ¬¡æ„å»ºéƒ½ä¼šè¿è¡Œ Trivy å®‰å…¨æ‰«æï¼š
- æ‰«æç»“æœä¸Šä¼ åˆ° GitHub Security æ ‡ç­¾é¡µ
- å‘ç°é«˜å±æ¼æ´ä¼šåœ¨ Actions æ—¥å¿—ä¸­è­¦å‘Š

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Ÿ

```bash
# ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬æ ‡ç­¾
docker pull weishaw/claude-relay-service:v1.0.0

# æˆ–åœ¨ docker-compose.yml ä¸­æŒ‡å®šç‰ˆæœ¬
image: weishaw/claude-relay-service:v1.0.0
```

### Q: å¦‚ä½•è·³è¿‡è‡ªåŠ¨æ„å»ºï¼Ÿ

åœ¨ commit æ¶ˆæ¯ä¸­æ·»åŠ  `[skip ci]`ï¼š
```bash
git commit -m "docs: æ›´æ–°æ–‡æ¡£ [skip ci]"
```

### Q: æ„å»ºå¤±è´¥å¦‚ä½•è°ƒè¯•ï¼Ÿ

1. æŸ¥çœ‹ Actions æ—¥å¿—è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. åœ¨æœ¬åœ°æµ‹è¯• Docker æ„å»ºï¼š
   ```bash
   docker build -t test .
   ```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Docker Hub é…ç½®æŒ‡å—](.github/DOCKER_HUB_SETUP.md)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)